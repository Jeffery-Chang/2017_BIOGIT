"use strict";window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),function(){new Vue({el:"#indexPage",data:{menuHeader:!1,loadFG:!1,goldFG:!1,goldStep:1,purpleFG:!1,purpleStep:1,switchCnt:2,actFG:!0,priFG:!1,gaV3:!0,gaV5:!0,gaV6:!0,goldData:{name:"",phone:"",address:"",gift:"A"},purpleData:{name:"",phone:"",address:"",gift:"B"}},created:function(){window.addEventListener("scroll",this.ctrlScroll)},beforeMount:function(){isMobile.phone&&(this.switchCnt=2)},mounted:function(){var e=this;window.onload=function(){e.loadFG=!0,e.setAndroid(),e.initKV(),e.initPatent(),isMobile.phone||e.initFamous(),e.initProduct(),e.initForm(),gapage("homepage")}},methods:{ctrlScroll:function(){var e=window.scrollY||document.documentElement.scrollTop;if(this.menuHeader=e>document.querySelector(".index").offsetHeight-100,this.menuHeader?document.querySelector("header").classList.add("show"):document.querySelector("header").classList.remove("show"),1==this.loadFG){document.getElementsByTagName("header")[0].offsetHeight;var t=document.querySelector(".wrap"),o=isMobile.phone?"40px":"80px";t.style.marginTop=1==this.menuHeader?o:""}var n=document.querySelector(".famous").offsetTop-document.querySelector(".famous").offsetHeight;1==this.gaV3&&e>n&&(gapage("V3"),this.gaV3=!1)},endGame:function(){var e=Date.parse("2018/01/15 00:00:00").valueOf();return Date.parse(new Date).valueOf()>=e},setOverFlow:function(){document.body.style.cssText=0==this.loadFG||1==this.goldFG||1==this.purpleFG||1==this.actFG?"overflow-y: hidden":""},moveToPdt:function(){var e=document.querySelector(".bg_2").offsetTop;this.scrollToY(e,500),isMobile.phone&&document.querySelector(".menuToggle input").click(),gaclick("product")},setAndroid:function(){(function(){var e=navigator.userAgent||navigator.vendor||window.opera;return!!/android/i.test(e)})()&&(screen.orientation.onchange=function(){"landscape"==screen.orientation.type.match(/\w+/)[0]&&$(".trans_bg").removeClass("input_focus")}),$("input").on("focus",function(){$(".trans_bg").addClass("input_focus")})},initKV:function(){if(!isMobile.phone){var e=document.querySelectorAll(".one"),t=document.querySelectorAll(".two"),o=document.querySelectorAll(".one, .two"),n=[".1",".3",".2",".5",".1"],a=["2","1.75","2.25","2","1.75"],l=TweenMax.to(e,.5,{opacity:1,scale:1,delay:.25,paused:!0}),c=TweenMax.to(t,.5,{opacity:1,scale:1,delay:.5,paused:!0,onComplete:function(){for(var e=0;e<o.length;e++)o[e].style.opacity="1",o[e].style.transform="scale(1)",o[e].style.animation="floatDown "+a[e]+"s ease infinite",o[e].style.animationDelay=n[e]+"s"}});l.play(),c.play()}},initEasy:function(){var e=document.querySelectorAll(".easy h1 p img, .easy h1 span, .easy h2 img"),t=document.querySelectorAll(".bubble_block li p"),o=[t[3],t[2],t[1],t[0]],n=new TimelineMax({paused:!0}),a=TweenMax.staggerTo(e,.5,{opacity:1,y:0,delay:.5},.2),l=TweenMax.staggerTo(o,.5,{scale:1},.2);n.add(a),n.add(l),TweenMax.set(e,{y:-50});new WOW({boxClass:"easy_kv",offset:200,callback:function(){n.play(),gapage("V1")}}).init()},initPatent:function(){var e=isMobile.phone?0:150,t=document.querySelectorAll(".text_block h1, .text_block h2, .text_block h3, .text_block .video"),o=isMobile.phone?"patent_kv_m":"patent_kv_pc",n=document.querySelector(".text_block .video");TweenMax.set(t,{opacity:0,y:-50}),WAMediaBox.bindAll(n);new WOW({boxClass:o,offset:e,delay:.5,callback:function(){gapage("V2"),TweenMax.staggerTo(t,.5,{opacity:1,y:0},.2,function(){TweenMax.set(t,{clearProps:"all"})})}}).init()},initFamous:function(){var e=document.querySelector(".switch_block .pre"),t=document.querySelector(".switch_block .next"),o=new Siema({selector:".switch_block ul",duration:500,easing:"ease",perPage:3,startIndex:0,draggable:!0,multipleDrag:!0,threshold:20,loop:!0,onInit:function(){},onChange:function(){}});e.addEventListener("click",function(){return o.prev(3)}),t.addEventListener("click",function(){return o.next(3)}),setInterval(function(){o.next(3)},5e3)},initProduct:function(){var e=document.querySelector(".pdt_block h1 img");if(e.classList.add("product_kv"),e.classList.add("fadeInDown"),e.setAttribute("data-wow-duration",".5s"),isMobile.phone){var t=document.querySelector(".pdt_block .gold_block"),o=document.querySelector(".pdt_block .purple_block"),n=document.querySelectorAll(".pdt_block .m_pdtBlock .open")[0],a=document.querySelectorAll(".pdt_block .m_pdtBlock .open")[1];t.classList.add("product_kv_g"),t.classList.add("fadeInDownSmall"),t.setAttribute("data-wow-duration",".5s"),o.classList.add("product_kv_p"),o.setAttribute("data-wow-duration",".5s"),o.classList.add("fadeInDownSmall"),TweenMax.set([n,a],{height:0,overflow:"hidden"});new WOW({boxClass:"product_kv",offset:0,delay:.1,callback:function(){gapage("V4")}}).init(),new WOW({boxClass:"product_kv_g",offset:0,delay:.1}).init(),new WOW({boxClass:"product_kv_p",offset:0,delay:.1}).init()}else{var l=isMobile.phone?0:150,c=document.querySelector(".cut_block.c_1"),i=document.querySelector(".cut_block.c_2"),r=document.querySelector(".pdt_block .triggle img"),s=document.querySelector(".pdt_block .gold img"),d=document.querySelector(".pdt_block .bubble_gold img"),u=document.querySelectorAll(".cut_block.c_2 .board_gold"),p=document.querySelector(".pdt_block .purple img"),m=document.querySelector(".pdt_block .bubble_purple img"),g=document.querySelectorAll(".cut_block.c_2 .board_purple"),h=new TimelineMax({paused:!0,delay:.5}),w=TweenMax.to(r,.5,{scale:1,delay:.15}),f=TweenMax.to([s,p,d,m],.5,{opacity:1,x:0,y:0,scale:1,delay:.15}),y=TweenMax.to(c,.5,{opacity:0,delay:.5,onComplete:function(){TweenMax.set(c,{display:"none"}),TweenMax.set(i,{display:"block"})}}),b=TweenMax.to(i,.5,{opacity:1}),k=TweenMax.to([u,g],.5,{opacity:1,x:0});h.add(w),h.add(f),h.add(y),h.add(b),h.add(k),TweenMax.set(r,{scale:0}),TweenMax.set([s,g],{opacity:0,x:-50}),TweenMax.set([p,u],{opacity:0,x:50}),TweenMax.set(d,{opacity:0,x:75,y:75,scale:.5}),TweenMax.set(m,{opacity:0,x:-100,y:-100,scale:.5}),TweenMax.set(i,{opacity:0});new WOW({boxClass:"product_kv",offset:l,delay:.1,callback:function(){gapage("V4"),h.play()}}).init()}},initForm:function(){var e=this,t=isMobile.phone?0:150,o=document.querySelector(".lottery h1 img"),n=document.querySelector(".lottery h2"),a=document.querySelector(".lottery h3"),l=document.querySelector(".lottery .choose_block"),c=document.querySelector(".lottery .gold_box img"),i=document.querySelector(".lottery .purple_box img"),r=new TimelineMax({paused:!0,delay:.55}),s=TweenMax.to(l,.5,{opacity:1}),d=TweenMax.to([c,i],.5,{opacity:1,x:0});r.add(s),r.add(d),TweenMax.set([l,c,i],{opacity:0}),TweenMax.set(c,{x:-50}),TweenMax.set(i,{x:50}),o.classList.add("form_kv"),o.classList.add("fadeInDown"),o.setAttribute("data-wow-duration","1s"),n.classList.add("form_kv"),n.classList.add("fadeInDown"),n.setAttribute("data-wow-duration","1s"),a.classList.add("form_kv"),a.classList.add("fadeInDown"),a.setAttribute("data-wow-duration","1s");new WOW({boxClass:"form_kv",offset:t,delay:.1,callback:function(){1==e.gaV5&&(gapage("V5"),e.gaV5=!1,r.play())}}).init()},disAct:function(e){e.preventDefault(),this.actFG=!0,this.$nextTick(function(){1==this.gaV6&&(gapage("V6"),this.gaV6=!1)}),gaclick("rule")},disImg:function(e,t){e.preventDefault();var o="gold"===t?document.querySelectorAll(".pdt_block .m_pdtBlock .open")[0]:document.querySelectorAll(".pdt_block .m_pdtBlock .open")[1],n="gold"===t?document.querySelectorAll(".pdt_block .m_pdtBlock .open img")[0].offsetHeight:document.querySelectorAll(".pdt_block .m_pdtBlock .open img")[1].offsetHeight;TweenMax.to(o,.5,{height:0===o.offsetHeight?n:"0px"}),"gold"===t?gaclick("gold"):gaclick("bounce")},openForm:function(e,t){this.endGame()?alert("活動已結束！\n獲獎名單將於1/25公布！"):(this.$data[e]=!0,gaclick(t))},sendShare:function(e){e.preventDefault();var t=new Date,o=t.getFullYear().toString()+(t.getMonth()+1).toString()+((t.getDate()<10?"0":"")+t.getDate().toString());this.shareFB(location.href,"?back=1&v="+o)},sendData:function(e,t){if(e&&e.preventDefault(),!this.endGame()){var o=this,n="",a=!1,l="";"gold"===t?(a=document.getElementById("checkbox").checked,CH.checktxt(this.goldData.name)||(n+="請填寫您的姓名\n"),CH.isValidCell(this.goldData.phone)||(n+="請填寫10碼的手機號碼(格式 0912345678)\n"),CH.checktxt(this.goldData.address)||(n+="請填寫您的地址\n"),a||(n+="請詳閱個人資料授權並同意"),l=this.goldData):"purple"===t&&(a=document.getElementById("checkbox_2").checked,CH.checktxt(this.purpleData.name)||(n+="請填寫您的姓名\n"),CH.isValidCell(this.purpleData.phone)||(n+="請填寫10碼的手機號碼(格式 0912345678)\n"),CH.checktxt(this.purpleData.address)||(n+="請填寫您的地址\n"),a||(n+="請詳閱個人資料授權並同意"),l=this.purpleData),n.length>0?alert(n):$.ajax({method:"POST",url:"https://bioessence.webgene.com.tw/api/Send_User",data:l,success:function(e){"200"===e.status?"gold"===t?(o.goldStep=2,gaclick("biogoldenter")):"purple"===t&&(o.purpleStep=2,gaclick("biobounceenter")):"110"===e.status?"gold"===t?(o.goldStep=3,gaclick("biogoldenter")):"purple"===t&&(o.purpleStep=3,gaclick("biobounceenter")):alert("資料傳送錯誤，請重新再試！")},error:function(){alert("系統繁忙，請稍候再試，謝謝！")}})}},shareFB:function(e,t){var o,n=isMobile.phone?"http://m.facebook.com/sharer.php?u=":"http://www.facebook.com/sharer.php?u=";o=e+(t||""),window.open(n+encodeURIComponent(o),"sharer","toolbar=0,status=0,width=656,height=436")},scrollToY:function(e,t,o){function n(){var t=(l+=1/60)/c,r=i[o](t);t<1?(requestAnimFrame(n),window.scrollTo(0,a+(e-a)*r)):window.scrollTo(0,e)}var a=window.scrollY||document.documentElement.scrollTop,e=e||0,t=t||2e3,o=o||"easeOutSine",l=0,c=Math.max(.1,Math.min(Math.abs(a-e)/t,.8)),i={easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)}};n()}},destroyed:function(){window.removeEventListener("scroll",this.ctrlScroll)},watch:{loadFG:"setOverFlow",goldFG:"setOverFlow",purpleFG:"setOverFlow",actFG:"setOverFlow",priFG:"setOverFlow"}})}();